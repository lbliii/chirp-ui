{#- chirp-ui: Card component
    Headless card with optional header, footer, collapsible, and variants.

    Named slots: header_actions, media, default (body).

    Usage:
        from "chirpui/card.html" import card

        call card(title="My Card")
            <p>Card body content.</p>
        end

        call card(title="Settings", icon="⚙")
            {% slot header_actions %}<button>⋯</button>{% end %}
            <p>Body content.</p>
        end

        call card(title="Feature", variant="feature")
            {% slot media %}<img src="..." alt="...">{% end %}
            <p>Body content.</p>
        end
-#}

{% def card(title=none, subtitle=none, footer=none, collapsible=false, open=false, variant="", icon=none, cls="") %}
{% set variant_class = " chirpui-card--" ~ variant if variant else "" %}
{% if collapsible %}
<details class="chirpui-card chirpui-card--collapsible{{ variant_class }}{{ " " ~ cls if cls else "" }}"{% if open %} open{% end %}>
    {% if title %}
        <summary class="chirpui-card__header">
            {% if icon %}<span class="chirpui-card__icon">{{ icon }}</span>{% end %}
            <div class="chirpui-card__header-content">
                <span class="chirpui-card__title">{{ title }}</span>
                {% if subtitle %}<p class="chirpui-text-muted chirpui-font-sm">{{ subtitle }}</p>{% end %}
            </div>
            <div class="chirpui-card__header-actions">{% slot header_actions %}</div>
        </summary>
    {% end %}
    <div class="chirpui-card__media">{% slot media %}</div>
    <div class="chirpui-card__body">
        {% slot %}
    </div>
    {% if footer %}
        <footer class="chirpui-card__footer">{{ footer }}</footer>
    {% end %}
</details>
{% else %}
<article class="chirpui-card{{ variant_class }}{{ " " ~ cls if cls else "" }}">
    {% if title %}
        <header class="chirpui-card__header">
            {% if icon %}<span class="chirpui-card__icon">{{ icon }}</span>{% end %}
            <div class="chirpui-card__header-content">
                <span class="chirpui-card__title">{{ title }}</span>
                {% if subtitle %}<p class="chirpui-text-muted chirpui-font-sm">{{ subtitle }}</p>{% end %}
            </div>
            <div class="chirpui-card__header-actions">{% slot header_actions %}</div>
        </header>
    {% end %}
    <div class="chirpui-card__media">{% slot media %}</div>
    <div class="chirpui-card__body">
        {% slot %}
    </div>
    {% if footer %}
        <footer class="chirpui-card__footer">{{ footer }}</footer>
    {% end %}
</article>
{% end %}
{% end %}

{% def card_header(title, subtitle=none, icon=none, cls="") %}
<header class="chirpui-card__header{{ " " ~ cls if cls else "" }}">
    {% if icon %}<span class="chirpui-card__icon">{{ icon }}</span>{% end %}
    <div class="chirpui-card__header-content">
        <span class="chirpui-card__title">{{ title }}</span>
        {% if subtitle %}<p class="chirpui-text-muted chirpui-font-sm">{{ subtitle }}</p>{% end %}
    </div>
    <div class="chirpui-card__header-actions">
        {% slot %}
    </div>
</header>
{% end %}

{% def card_media(cls="") %}
<div class="chirpui-card__media{{ " " ~ cls if cls else "" }}">
    {% slot %}
</div>
{% end %}

{# Link-styled card for navigation/index grids #}
{% def card_link(href, title, cls="") %}
<a href="{{ href }}" class="chirpui-card chirpui-card--link{{ " " ~ cls if cls else "" }}" style="display: block; text-decoration: none; color: inherit;">
    <header class="chirpui-card__header">{{ title }}</header>
    <div class="chirpui-card__body">
        {% slot %}
    </div>
</a>
{% end %}
